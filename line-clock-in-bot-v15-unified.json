{
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "LineWebhook",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -4288,
        176
      ],
      "id": "c9b9a1e7-7f46-49ec-8701-b880451a24c3",
      "name": "LINE Webhook",
      "webhookId": "33bf5535-b41e-4285-ad67-41d644938ae9"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "userId",
              "name": "userId",
              "value": "={{ $json.body.events[0].source.userId }}",
              "type": "string"
            },
            {
              "id": "replyToken",
              "name": "replyToken",
              "value": "={{ $json.body.events[0].replyToken }}",
              "type": "string"
            },
            {
              "id": "eventType",
              "name": "eventType",
              "value": "={{ $json.body.events[0].type }}",
              "type": "string"
            },
            {
              "id": "msgType",
              "name": "msgType",
              "value": "={{ $json.body.events[0].message?.type || 'postback' }}",
              "type": "string"
            },
            {
              "id": "msgText",
              "name": "msgText",
              "value": "={{ $json.body.events[0].message?.text || '' }}",
              "type": "string"
            },
            {
              "id": "postbackData",
              "name": "postbackData",
              "value": "={{ $json.body.events[0].postback?.data || '' }}",
              "type": "string"
            },
            {
              "id": "msgId",
              "name": "msgId",
              "value": "={{ $json.body.events[0].message?.id || '' }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "72ee5a0c-d0aa-4549-a62a-fd948596f7cd",
      "name": "æ“·å–è¨Šæ¯è³‡è¨Š",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3856,
        208
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UserID",
              "lookupValue": "={{ $json.userId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "34f27a9d-5d19-4d41-b05f-9b8716cece2a",
      "name": "æŸ¥è©¢å“¡å·¥è¡¨",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -3632,
        208
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "found",
              "leftValue": "={{ $json.UserID }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "4d5945dd-be6b-446f-9642-4445d574f791",
      "name": "å“¡å·¥æ˜¯å¦å­˜åœ¨",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -3408,
        208
      ]
    },
    {
      "parameters": {
        "operation": "getProfile",
        "userId": "={{ $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json.userId }}"
      },
      "id": "964ecdb8-fd2f-44c4-8104-50aec0583c32",
      "name": "å–å¾—LINEå€‹è³‡",
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        -3088,
        320
      ],
      "credentials": {
        "lineMessagingApi": {
          "id": "UiiMHjlAZGMI80LW",
          "name": "æ‰“å¡æ©Ÿå™¨äºº"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json.userId }}",
            "current_step": "WAIT_LANG",
            "æš±ç¨±": "={{ $json.profile ? $json.profile.displayName : ($json.displayName || '') }}",
            "last_active": "={{ new Date().getTime() }}",
            "Language": "zh-TW"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æš±ç¨±",
              "displayName": "æš±ç¨±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å…¥è·æ—¥",
              "displayName": "å…¥è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é›¢è·æ—¥",
              "displayName": "é›¢è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ™‚è–ª",
              "displayName": "æ™‚è–ª",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è­‰ä»¶ç…§ç‰‡",
              "displayName": "è­‰ä»¶ç…§ç‰‡",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "temp_data",
              "displayName": "temp_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Language",
              "displayName": "Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "006c353e-49ad-43f9-8980-6da9acdb34e5",
      "name": "å»ºç«‹æ–°å“¡å·¥",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2912,
        336
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const d = $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json;\nconst flexContents = {\n  type: 'bubble',\n  body: {\n    type: 'box',\n    layout: 'vertical',\n    contents: [\n      { type: 'text', text: 'ğŸ‘‹ æ­¡è¿åŠ å…¥ï¼/ ChÃ o má»«ng!', weight: 'bold', size: 'lg', align: 'center' },\n      { type: 'separator', margin: 'md' },\n      {\n        type: 'box',\n        layout: 'horizontal',\n        margin: 'lg',\n        spacing: 'sm',\n        contents: [\n          { type: 'button', style: 'primary', color: '#06C755', action: { type: 'postback', label: 'ğŸ‡¹ğŸ‡¼ ç¹é«”ä¸­æ–‡', data: 'action=lang&value=zh-TW' } },\n          { type: 'button', style: 'secondary', action: { type: 'postback', label: 'ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t', data: 'action=lang&value=vi-VN' } }\n        ]\n      }\n    ]\n  }\n};\nreturn {\n  json: {\n    replyToken: d.replyToken,\n    replyType: 'flex',\n    text: 'è«‹é¸æ“‡èªè¨€',\n    altText: 'è«‹é¸æ“‡èªè¨€',\n    flexContents: flexContents\n  }\n};"
      },
      "id": "a1267d1b-4e26-4266-bf9e-fa873632715b",
      "name": "å›è¦†èªè¨€é¸å–®",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2752,
        416
      ]
    },
    {
      "parameters": {
        "jsCode": "const emp = $('æŸ¥è©¢å“¡å·¥è¡¨').item.json;\nconst input = $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json;\nconst now = new Date();\nconst lastActive = emp.last_active ? new Date(isNaN(Number(emp.last_active)) ? emp.last_active : Number(emp.last_active)) : new Date(0);\nconst TIMEOUT_MS = 10 * 60 * 1000;\nconst isTimeout = (now - lastActive) > TIMEOUT_MS && emp.current_step && emp.current_step !== 'IDLE';\nconst pbData = input.postbackData || '';\nconst pbParams = {};\npbData.split('&').forEach(p => { const [k, v] = p.split('='); if (k && v) pbParams[k] = decodeURIComponent(v); });\nconst MSG = {'zh-TW': {timeout: 'â° æ“ä½œé€¾æ™‚', cancel: 'âœ… å·²å–æ¶ˆ', selectStore: 'è«‹é¸æ“‡é–€å¸‚ ğŸ‘‡', storeList: 'è«‹é¸æ“‡é–€å¸‚ ğŸ‘‡', photoIn: 'ğŸ“¸ è«‹æ‹æ”ä¸Šç­ç…§', photoOut: 'ğŸ“¸ è«‹æ‹æ”ä¸‹ç­ç…§', photoId: 'ğŸ“¸ è«‹æ‹æ”è­‰ä»¶ç…§', askPhoto: 'ğŸ“¸ è«‹æ‹æ”è­‰ä»¶ç…§', wrongInput: 'â“ è«‹ä¾æŒ‡ç¤ºæ“ä½œ', regOk: 'âœ… è¨»å†ŠæˆåŠŸï¼', inOk: 'âœ… ä¸Šç­æˆåŠŸï¼', outOk: 'âœ… ä¸‹ç­æˆåŠŸï¼', help: 'ğŸ“‹ æŒ‡ä»¤ï¼šä¸Šç­/ä¸‹ç­/å–æ¶ˆ', noClockIn: 'âš ï¸ ä»Šæ—¥å°šæœªæ‰“ä¸Šç­å¡', askRevenue: 'ğŸ’° è«‹è¼¸å…¥ç•¶å‰æ¥­ç¸¾:', revenueOk: 'âœ… å·²è¨˜éŒ„æ¥­ç¸¾', welcome: 'æ­¡è¿åŠ å…¥ï¼', selectLang: 'è«‹é¸æ“‡èªè¨€', helper: 'âœ¨ æ‚¨æ˜¯ä»Šæ—¥å°å¹«æ‰‹ (å…æ¥­ç¸¾)', opener: 'ğŸ¯ æ‚¨æ˜¯é¦–ä½é–‹æ”¤', midshift: 'ğŸ•’ ä¸­é€”ä¸Šç­ï¼Œè«‹å…ˆè¼¸å…¥æ¥­ç¸¾'}, 'vi-VN': {timeout: 'â° Háº¿t giá»', cancel: 'âœ… ÄÃ£ há»§y', selectStore: 'Chá»n cá»­a hÃ ng ğŸ‘‡', storeList: 'Chá»n cá»­a hÃ ng ğŸ‘‡', photoIn: 'ğŸ“¸ Chá»¥p áº£nh Ä‘i lÃ m', photoOut: 'ğŸ“¸ Chá»¥p áº£nh tan ca', photoId: 'ğŸ“¸ Chá»¥p áº£nh ID', askPhoto: 'ğŸ“¸ Vui lÃ²ng chá»¥p áº£nh ID', wrongInput: 'â“ LÃ m theo hÆ°á»›ng dáº«n', regOk: 'âœ… ÄÄƒng kÃ½ xong!', inOk: 'âœ… Äi lÃ m OK!', outOk: 'âœ… Tan ca OK!', help: 'ğŸ“‹ Lá»‡nh: Báº¯t Ä‘áº§u/Káº¿t thÃºc/Há»§y', noClockIn: 'âš ï¸ ChÆ°a cháº¥m cÃ´ng', askRevenue: 'ğŸ’° Nháº­p doanh sá»‘:', revenueOk: 'âœ… ÄÃ£ ghi doanh sá»‘', welcome: 'Xin chÃ o!', selectLang: 'Vui lÃ²ng chá»n ngÃ´n ngá»¯', helper: 'âœ¨ Báº¡n lÃ  trá»£ lÃ½ (KhÃ´ng cáº§n KPI)', opener: 'ğŸ¯ Báº¡n lÃ  ngÆ°á»i má»Ÿ hÃ ng', midshift: 'ğŸ•’ Ca giá»¯a, vui lÃ²ng nháº­p doanh sá»‘'}};\nconst lang = emp.Language || 'zh-TW';\nconst t = MSG[lang] || MSG['zh-TW'];\nlet tempData = {};\ntry { tempData = emp.temp_data ? JSON.parse(emp.temp_data) : {}; } catch(e) {}\nreturn { json: { ...input, emp, lang, t, MSG_DICT: MSG, isTimeout, step: emp.current_step || 'IDLE', tempData, pbParams, combinedAction: pbParams.action || '', combinedValue: pbParams.value || pbParams.store || '' } };"
      },
      "id": "0be1bf15-656f-4ca4-abe2-931a568096a8",
      "name": "è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3200,
        -16
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.msgText }}",
                    "rightValue": "å–æ¶ˆ",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "03952d1c-e9d2-4719-bafc-4b470e9f0082"
                  },
                  {
                    "leftValue": "={{ $json.combinedAction }}",
                    "rightValue": "cancel",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "5cc708ca-8a99-424e-b429-fc6e5bf41543"
                  }
                ],
                "combinator": "or"
              },
              "renameOutput": true,
              "outputKey": "å–æ¶ˆ"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "IDLE",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "70b406cf-5b11-48f6-809a-2fea3cb9d703"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "IDLE"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_LANG",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "4b23b7d4-b839-4a64-910d-d549868294d3"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "WAIT_LANG"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_STORE_IN",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "c19d5337-f1cf-4f67-8a34-5e9bf8294ba6"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "WAIT_STORE_IN"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_STORE_OUT",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "6946e0b7-8181-407f-8ed4-af3c67170987"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "WAIT_STORE_OUT"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_REVENUE",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "f3f547ba-bfb3-44fb-966b-8452bbcc37f0"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "WAIT_REVENUE"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_PHOTO_REG",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "8c77d41b-4895-4dc9-b5d1-50aa9aa81a87"
                  },
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_PHOTO_IN",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "c44384d5-0f25-45a7-ac7c-04fdddf1cad1"
                  },
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_PHOTO_OUT",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a2ca53a9-d5c7-41a4-83e3-160fa137a4ab"
                  }
                ],
                "combinator": "or"
              },
              "renameOutput": true,
              "outputKey": "WAIT_PHOTO"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "id": "57705781-fbe5-4870-89c3-d1165f39533a",
      "name": "ç‹€æ…‹è·¯ç”±",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        -2752,
        112
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $json.userId }}",
            "current_step": "IDLE",
            "temp_data": ""
          },
          "matchingColumns": [
            "UserID"
          ]
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "74d709b5-0436-4c81-b0b5-a19498bca2a4",
      "name": "é‡ç½®(å–æ¶ˆ)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2528,
        -32
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2,
                  "combinator": "or"
                },
                "conditions": [
                  {
                    "id": "match-daka",
                    "leftValue": "={{ $json.msgText }}",
                    "rightValue": "æ‰“å¡",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  },
                  {
                    "id": "match-punch",
                    "leftValue": "={{ $json.msgText }}",
                    "rightValue": "Punch",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "æ‰“å¡"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2,
                  "combinator": "or"
                },
                "conditions": [
                  {
                    "id": "match-shangban",
                    "leftValue": "={{ $json.msgText }}",
                    "rightValue": "ä¸Šç­",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  },
                  {
                    "id": "match-batdau",
                    "leftValue": "={{ $json.msgText }}",
                    "rightValue": "Báº¯t Ä‘áº§u",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "ä¸Šç­"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2,
                  "combinator": "or"
                },
                "conditions": [
                  {
                    "id": "match-xiaban",
                    "leftValue": "={{ $json.msgText }}",
                    "rightValue": "ä¸‹ç­",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  },
                  {
                    "id": "match-ketthuc",
                    "leftValue": "={{ $json.msgText }}",
                    "rightValue": "Káº¿t thÃºc",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "ä¸‹ç­"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "id": "f293673c-2941-4bb5-89f4-3d3dab79f6e4",
      "name": "æŒ‡ä»¤åˆ¤æ–·",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        -2528,
        112
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $json.userId }}",
            "current_step": "WAIT_STORE_IN",
            "temp_data": "ä¸Šç­",
            "last_active": "={{ new Date().getTime() }}"
          },
          "matchingColumns": [
            "UserID"
          ]
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "e89e909a-38ee-4172-9199-7db038b5b3d0",
      "name": "è¨­å®šç­‰é¸åº—(ä¸Š)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2256,
        -320
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥å·¥æ™‚ç´€éŒ„",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "å“¡å·¥å§“å",
              "lookupValue": "={{ $json.emp.æš±ç¨± }}"
            },
            {
              "lookupColumn": "æ—¥æœŸ",
              "lookupValue": "={{ new Date().getFullYear() + '/' + String(new Date().getMonth()+1).padStart(2,'0') + '/' + String(new Date().getDate()).padStart(2,'0') }}"
            }
          ]
        },
        "options": {
          "includeRowNumber": true
        }
      },
      "id": "0f0a9700-ade7-473a-b75a-4936eb23e794",
      "name": "æŸ¥è©¢ä»Šæ—¥æ‰“å¡ç´€éŒ„",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2352,
        208
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "has-clockin",
              "leftValue": "={{ $json.ä¸Šç­æ™‚é–“ }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "c3859da2-6581-4679-b3c3-eda71d53bc92",
      "name": "ä»Šæ—¥å·²æ‰“ä¸Šç­?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -2096,
        144
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json.userId }}",
            "current_step": "WAIT_STORE_OUT",
            "temp_data": "ä¸‹ç­",
            "last_active": "={{ new Date().getTime() }}"
          },
          "matchingColumns": [
            "UserID"
          ]
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "68dcf3d9-0881-4761-be04-72cd4ea3fdaf",
      "name": "è¨­å®šç­‰é¸åº—(ä¸‹)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1872,
        128
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const d = $input.item.json;\nconst store = d.combinedValue || d.pbParams.store || d.msgText;\nconst action = 'clockin';\nconst newTemp = JSON.stringify({ action, store });\nreturn { json: { ...d, store, action, newTemp } };"
      },
      "id": "286856ea-bed9-4583-8b88-e1df8c560ddc",
      "name": "è§£æåº—å(ä¸Šç­)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2528,
        304
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "æ¯æ—¥æ¥­ç¸¾ç´€éŒ„",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "åº—å",
              "lookupValue": "={{ $json.store }}"
            }
          ]
        },
        "options": {}
      },
      "id": "891b5885-e8c6-4137-aa10-c406ca410f04",
      "name": "æŸ¥è©¢æ¯æ—¥æ¥­ç¸¾ç´€éŒ„",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2320,
        304
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const prev = $('è§£æåº—å(ä¸Šç­)').item.json;\nconst dailyRevRows = $input.all();\nconst store = prev.store;\n// å°ç£æ™‚å€ UTC+8\nconst now = new Date();\nconst twOffset = 8 * 60 * 60 * 1000;\nconst twNow = new Date(now.getTime() + twOffset);\nconst todayStr = `${twNow.getUTCFullYear()}/${String(twNow.getUTCMonth()+1).padStart(2,'0')}/${String(twNow.getUTCDate()).padStart(2,'0')}`;\nconst todayRecords = dailyRevRows.filter(r => {\n  const d = r.json['æ—¥æœŸ'] || '';\n  return d.includes(todayStr) || d.startsWith(`${twNow.getUTCMonth()+1}/${twNow.getUTCDate()}`);\n});\nlet clockInType = 'opener';\nlet openTime = null;\nif (todayRecords.length > 0 && todayRecords[0].json['é–‹æ”¤æ™‚é–“']) {\n  const openTimeStr = todayRecords[0].json['é–‹æ”¤æ™‚é–“'];\n  const match = openTimeStr.match(/(\\d{1,2}):(\\d{2})/);\n  if (match) {\n    let hour = parseInt(match[1]);\n    const min = parseInt(match[2]);\n    if (openTimeStr.includes('ä¸‹åˆ') && hour < 12) hour += 12;\n    const diffHr = (twNow.getUTCHours() * 60 + twNow.getUTCMinutes() - (hour * 60 + min)) / 60;\n    clockInType = diffHr < 1 ? 'helper' : 'midshift';\n  }\n}\nlet tempObj = {};\ntry { tempObj = JSON.parse(prev.newTemp); } catch(e) { tempObj = { raw: prev.newTemp }; }\nconst newTemp = JSON.stringify({ ...tempObj, store, clockInType, clockInTime: twNow.toISOString() });\nreturn { json: { ...prev, store, clockInType, hasOpenRecord: todayRecords.length > 0, newTemp } };"
      },
      "id": "0482e3d9-f7aa-4feb-9bda-adc78e39e89d",
      "name": "åˆ¤æ–·é–‹æ”¤ç‹€æ…‹",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2096,
        304
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "combinator": "and"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.clockInType }}",
                    "rightValue": "opener",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "é¦–ä½é–‹æ”¤"
            },
            {
              "conditions": {
                "options": {
                  "combinator": "and"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.clockInType }}",
                    "rightValue": "helper",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "å°å¹«æ‰‹"
            },
            {
              "conditions": {
                "options": {
                  "combinator": "and"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.clockInType }}",
                    "rightValue": "midshift",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "ä¸­é€”ä¸Šç­"
            }
          ]
        },
        "options": {}
      },
      "id": "d523aabc-204a-431f-a6ba-0815038b4550",
      "name": "é–‹æ”¤é¡å‹è·¯ç”±",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        -1872,
        304
      ]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "æ¯æ—¥æ¥­ç¸¾ç´€éŒ„",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "æ—¥æœŸ": "={{ new Date().getFullYear() + '/' + String(new Date().getMonth()+1).padStart(2,'0') + '/' + String(new Date().getDate()).padStart(2,'0') }}",
            "åº—å": "={{ $json.store }}",
            "é–‹æ”¤æ™‚é–“": "={{ new Date().toLocaleString('zh-TW') }}",
            "ç´€éŒ„è€…": "={{ $json.emp.æš±ç¨± }}",
            "ç´€éŒ„æ™‚é–“": "={{ new Date().toLocaleString('zh-TW') }}"
          },
          "matchingColumns": [
            "æ—¥æœŸ",
            "åº—å"
          ],
          "schema": [
            {
              "id": "æ—¥æœŸ",
              "displayName": "æ—¥æœŸ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "åº—å",
              "displayName": "åº—å",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "é–‹æ”¤æ™‚é–“",
              "displayName": "é–‹æ”¤æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æ¥­ç¸¾ç´€éŒ„",
              "displayName": "æ¥­ç¸¾ç´€éŒ„",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æœ€çµ‚çµç®—",
              "displayName": "æœ€çµ‚çµç®—",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·®ç•°",
              "displayName": "å·®ç•°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ç´€éŒ„è€…",
              "displayName": "ç´€éŒ„è€…",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç´€éŒ„æ™‚é–“",
              "displayName": "ç´€éŒ„æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "c94fa186-a8bc-487e-8eb6-452f732008cd",
      "name": "æ–°å¢é–‹æ”¤ç´€éŒ„",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1648,
        256
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('åˆ¤æ–·é–‹æ”¤ç‹€æ…‹').item.json.userId }}",
            "current_step": "WAIT_PHOTO_IN",
            "temp_data": "={{ $('åˆ¤æ–·é–‹æ”¤ç‹€æ…‹').item.json.newTemp }}",
            "row_number": 0
          },
          "matchingColumns": [
            "UserID"
          ],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æš±ç¨±",
              "displayName": "æš±ç¨±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å…¥è·æ—¥",
              "displayName": "å…¥è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é›¢è·æ—¥",
              "displayName": "é›¢è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ™‚è–ª",
              "displayName": "æ™‚è–ª",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è­‰ä»¶ç…§ç‰‡",
              "displayName": "è­‰ä»¶ç…§ç‰‡",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "temp_data",
              "displayName": "temp_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Language",
              "displayName": "Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "e83f6b79-19fc-4de4-9c6a-d512a796337b",
      "name": "è¨­å®šç­‰ç…§ç‰‡(ä¸Š)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1056,
        144
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('åˆ¤æ–·é–‹æ”¤ç‹€æ…‹').item.json.userId }}",
            "current_step": "WAIT_REVENUE",
            "temp_data": "ä¸­é€”",
            "row_number": 0
          },
          "matchingColumns": [
            "UserID"
          ],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æš±ç¨±",
              "displayName": "æš±ç¨±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å…¥è·æ—¥",
              "displayName": "å…¥è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é›¢è·æ—¥",
              "displayName": "é›¢è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ™‚è–ª",
              "displayName": "æ™‚è–ª",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è­‰ä»¶ç…§ç‰‡",
              "displayName": "è­‰ä»¶ç…§ç‰‡",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "temp_data",
              "displayName": "temp_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Language",
              "displayName": "Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "27103aae-83dc-4c6e-8120-00d9396f7c5e",
      "name": "è¨­å®šç­‰æ¥­ç¸¾(ä¸­é€”)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1424,
        432
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const d = $input.item.json;\nconst store = d.combinedValue || d.pbParams.store || d.msgText;\nconst action = 'clockout';\nconst newTemp = JSON.stringify({ action, store });\nreturn { json: { ...d, store, action, newTemp } };"
      },
      "id": "766c6b3e-00b8-47fb-97be-2add395cd697",
      "name": "è§£æåº—å(ä¸‹ç­)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2528,
        464
      ]
    },
    {
      "parameters": {
        "jsCode": "const prev = $('è§£æåº—å(ä¸‹ç­)').item.json;\nconst emp = prev.emp;\nlet helper = false;\n// ç°¡å–®åˆ¤æ–·ï¼šè‹¥ current_step æ›¾è¨˜éŒ„æ˜¯ helper æˆ– tempData è£¡æœ‰æ¨™è¨˜\nif (prev.t.helper) {/*ä¸åšé¡å¤–åˆ¤æ–·ï¼Œç”±è·¯ç”±æ±ºå®š*/} \n// é€™è£¡å‡è¨­è‹¥ç‚ºhelperï¼Œä¸éœ€æ¥­ç¸¾\n// å¯¦å‹™ä¸Šå¯åˆ°Google SheetæŸ¥ä»Šæ—¥ä¸Šç­è‹¥æ˜¯helperå‰‡ä¸éœ€æ¥­ç¸¾\nreturn { json: { ...prev } };"
      },
      "id": "97e6e580-b2cc-4917-a006-2580ec925725",
      "name": "åˆ¤æ–·æ˜¯å¦éœ€æ¥­ç¸¾(ä¸‹)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2304,
        464
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "need-rev",
              "leftValue": "={{ $json.msgText }}",
              "rightValue": "NO_NEED",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "2775f0f3-b1d5-45ea-8c29-37380f277109",
      "name": "éœ€æ¥­ç¸¾?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -2096,
        464
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('åˆ¤æ–·æ˜¯å¦éœ€æ¥­ç¸¾(ä¸‹)').item.json.userId }}",
            "current_step": "WAIT_REVENUE",
            "temp_data": "={{ $json.newTemp }}",
            "row_number": 0
          },
          "matchingColumns": [
            "UserID"
          ],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æš±ç¨±",
              "displayName": "æš±ç¨±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å…¥è·æ—¥",
              "displayName": "å…¥è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é›¢è·æ—¥",
              "displayName": "é›¢è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ™‚è–ª",
              "displayName": "æ™‚è–ª",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è­‰ä»¶ç…§ç‰‡",
              "displayName": "è­‰ä»¶ç…§ç‰‡",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "temp_data",
              "displayName": "temp_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Language",
              "displayName": "Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "24960309-843b-4828-91ed-327c10b77b7f",
      "name": "è¨­å®šç­‰æ¥­ç¸¾(ä¸‹)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1840,
        512
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('åˆ¤æ–·æ˜¯å¦éœ€æ¥­ç¸¾(ä¸‹)').item.json.userId }}",
            "current_step": "WAIT_PHOTO_OUT",
            "temp_data": "={{ $json.newTemp }}",
            "row_number": 0
          },
          "matchingColumns": [
            "UserID"
          ],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æš±ç¨±",
              "displayName": "æš±ç¨±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å…¥è·æ—¥",
              "displayName": "å…¥è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é›¢è·æ—¥",
              "displayName": "é›¢è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ™‚è–ª",
              "displayName": "æ™‚è–ª",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è­‰ä»¶ç…§ç‰‡",
              "displayName": "è­‰ä»¶ç…§ç‰‡",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "temp_data",
              "displayName": "temp_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Language",
              "displayName": "Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "b3e9447e-85c8-479c-b17b-d0a51c4119d5",
      "name": "è¨­å®šç­‰ç…§ç‰‡(ä¸‹)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1840,
        368
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const d = $input.item.json;\nconst revenue = parseInt(d.msgText.replace(/\\D/g, '')) || 0;\nconst prevTemp = d.tempData || {};\nconst newTemp = JSON.stringify({ ...prevTemp, revenue });\nreturn { json: { ...d, revenue, newTemp } };"
      },
      "id": "84d5f470-3490-4886-af62-aa11b84cd123",
      "name": "è§£ææ¥­ç¸¾é‡‘é¡",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2528,
        640
      ]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "æ¯æ—¥æ¥­ç¸¾ç´€éŒ„",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "æ—¥æœŸ": "={{ new Date().getFullYear() + '/' + String(new Date().getMonth()+1).padStart(2,'0') + '/' + String(new Date().getDate()).padStart(2,'0') }}",
            "åº—å": "={{ $json.tempData.store }}",
            "æ¥­ç¸¾ç´€éŒ„": "={{ $json.revenue }}",
            "ç´€éŒ„è€…": "={{ $json.emp.æš±ç¨± }}",
            "ç´€éŒ„æ™‚é–“": "={{ new Date().toLocaleString('zh-TW') }}"
          },
          "matchingColumns": [
            "æ—¥æœŸ",
            "åº—å"
          ],
          "schema": [
            {
              "id": "æ—¥æœŸ",
              "displayName": "æ—¥æœŸ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "åº—å",
              "displayName": "åº—å",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é–‹æ”¤æ™‚é–“",
              "displayName": "é–‹æ”¤æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ¥­ç¸¾ç´€éŒ„",
              "displayName": "æ¥­ç¸¾ç´€éŒ„",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æœ€çµ‚çµç®—",
              "displayName": "æœ€çµ‚çµç®—",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·®ç•°",
              "displayName": "å·®ç•°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ç´€éŒ„è€…",
              "displayName": "ç´€éŒ„è€…",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ç´€éŒ„æ™‚é–“",
              "displayName": "ç´€éŒ„æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "4b6fc5df-7c87-43ca-9fc6-5743b3547844",
      "name": "å¯«å…¥æ¥­ç¸¾ç´€éŒ„",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2336,
        640
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json.tempData.action }}",
                    "rightValue": "clockold",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "c76fb924-f5f4-41d9-8380-6060c41097e8"
                  },
                  {
                    "leftValue": "={{ $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json.tempData.action }}",
                    "rightValue": "clockout",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "75c32454-3e91-4566-a320-138374a2b251"
                  }
                ],
                "combinator": "or"
              },
              "renameOutput": true,
              "outputKey": "ä¸‹ç­æµç¨‹"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "id": "89b51fa5-6c17-4952-ba6c-850f7572620d",
      "name": "æ±ºå®šä¸‹ä¸€æ­¥",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        -2112,
        640
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json.userId }}",
            "current_step": "WAIT_PHOTO_OUT",
            "temp_data": "={{ $('è§£ææ¥­ç¸¾é‡‘é¡').item.json.newTemp }}",
            "row_number": 0
          },
          "matchingColumns": [
            "UserID"
          ],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æš±ç¨±",
              "displayName": "æš±ç¨±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å…¥è·æ—¥",
              "displayName": "å…¥è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é›¢è·æ—¥",
              "displayName": "é›¢è·æ—¥",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ™‚è–ª",
              "displayName": "æ™‚è–ª",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è­‰ä»¶ç…§ç‰‡",
              "displayName": "è­‰ä»¶ç…§ç‰‡",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "temp_data",
              "displayName": "temp_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Language",
              "displayName": "Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "0652750e-b2d9-48e0-bb12-8927909cd35e",
      "name": "è¨­å®šç­‰ç…§ç‰‡(æ¥­ç¸¾å¾Œ)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1872,
        640
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const d = $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json;\nconst postbackData = d.postbackData || '';\nlet lang = 'zh-TW';\n\n// è§£æ Postback Data (ä¾‹å¦‚: \"action=lang&value=vi-VN\")\nif (postbackData.includes('value=')) {\n  const match = postbackData.match(/value=([^&]+)/);\n  if (match && match[1]) {\n    lang = match[1];\n  }\n}\n\n// è‹¥è§£æå¤±æ•—æˆ–éåˆæ³•å€¼ï¼Œé è¨­ zh-TW\nif (lang !== 'vi-VN' && lang !== 'zh-TW') {\n    lang = 'zh-TW';\n}\n\nreturn { json: { ...d, lang } };"
      },
      "id": "e320f77d-77f6-4076-8806-0371a364d0d0",
      "name": "è§£æèªè¨€é¸æ“‡",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2528,
        56
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json.userId }}",
            "current_step": "WAIT_PHOTO_REG",
            "Language": "={{ $json.lang }}",
            "last_active": "={{ new Date().getTime() }}"
          },
          "matchingColumns": [
            "UserID"
          ]
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "713997cc-b333-4fde-b565-d064cfb8070d",
      "name": "å„²å­˜èªè¨€è¨­å®š",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2304,
        56
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "method": "GET",
        "url": "={{ 'https://api-data.line.me/v2/bot/message/' + $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json.msgId + '/content' }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "lineMessagingApi",
        "responseFormat": "file",
        "options": {}
      },
      "id": "2bc98c19-6126-4ca9-ad20-7b587a8f3310",
      "name": "ä¸‹è¼‰LINEç…§ç‰‡",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2256,
        -160
      ],
      "credentials": {
        "lineMessagingApi": {
          "id": "UiiMHjlAZGMI80LW",
          "name": "æ‰“å¡æ©Ÿå™¨äºº"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "is-image",
              "leftValue": "={{ $json.msgType }}",
              "rightValue": "image",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "2d7b42aa-d421-4d37-84bc-07e335277416",
      "name": "æ˜¯å¦ç‚ºç…§ç‰‡",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -2720,
        -112
      ]
    },
    {
      "parameters": {
        "jsCode": "const d = $input.item.json;\nconst emp = d.emp || {};\nconst tempData = d.tempData || {};\nconst store = tempData.store || '';\nconst nickname = emp['æš±ç¨±'] || d.userId;\nconst step = emp.current_step;\n\n// åˆ¤æ–·å‹•ä½œ\nlet action = '';\nif (step === 'WAIT_PHOTO_IN') action = 'ä¸Šç­';\nelse if (step === 'WAIT_PHOTO_OUT') action = 'ä¸‹ç­';\nelse if (step === 'WAIT_PHOTO_REG') action = 'è¨»å†Š';\n\n// æ ¼å¼åŒ–æ™‚é–“ (å°ç£æ™‚å€ UTC+8)\nconst now = new Date(new Date().getTime() + 8 * 60 * 60 * 1000); // Shift to TW time roughly (or trust system time if already TW)\n// Better: just use simple UTC methods + 8 offset manually or string manipulation\n// Assuming n8n runs in UTC usually.\nconst twTime = new Date(new Date().toLocaleString('en-US', { timeZone: 'Asia/Taipei' }));\n\nconst year = twTime.getFullYear();\nconst month = String(twTime.getMonth() + 1).padStart(2, '0');\nconst day = String(twTime.getDate()).padStart(2, '0');\nconst dateStr = `${year}/${month}/${day}`;\n\nlet hours = twTime.getHours();\nconst ampm = hours >= 12 ? 'ä¸‹åˆ' : 'ä¸Šåˆ';\nhours = hours % 12;\nhours = hours ? hours : 12;\nconst minutes = String(twTime.getMinutes()).padStart(2, '0');\nconst seconds = String(twTime.getSeconds()).padStart(2, '0');\nconst timeStr = `${ampm} ${hours}:${minutes}:${seconds}`;\n\n// çµ„åˆæª”å\nlet prefix = '';\nif (store) prefix += `[${store}]`;\nprefix += `[${nickname}${action}]`;\n\nconst fileName = `${prefix} ${dateStr} ${timeStr}.jpg`;\n\nreturn { json: { ...d, fileName, dateStr, timeStr } };"
      },
      "id": "f5814521-82e4-411a-a1cc-c6cb9fcf8251",
      "name": "ç”Ÿæˆæª”å",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2528,
        -160
      ]
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "fileContent": "={{ $binary.data }}",
        "name": "={{ $('ç”Ÿæˆæª”å').item.json.fileName }}",
        "parents": [
          "1N-wFv0JvB-51sU3bIG5v1GXe4huO2J8V"
        ],
        "options": {}
      },
      "id": "31ea2803-366a-4b95-a18a-f506e537e738",
      "name": "ä¸Šå‚³Drive",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -2000,
        -160
      ],
      "credentials": {
        "googleApi": {
          "id": "eJwbv20hZJHx5y6W",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const drive = $input.item.json;\nconst driveLink = drive.webViewLink;\n// å–å¾—æœ€åŸå§‹çš„inputè³‡æ–™ä»¥çŸ¥é“ç•¶å‰step\nconst rootItem = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst step = rootItem.step;\n\n// å˜—è©¦è§£æ temp_data ä»¥å–å¾— row_number (é‡å°ä¸‹ç­æ‰“å¡)\nlet row_number = 0;\ntry {\n  const temp = typeof rootItem.temp_data === 'string' ? JSON.parse(rootItem.temp_data) : rootItem.temp_data;\n  if (temp && temp.row_number) {\n    row_number = parseInt(temp.row_number);\n  }\n} catch (e) {}\n\n// å¾ã€Œç”Ÿæˆæª”åã€ç¯€é»å–å¾—æ—¥æœŸæ™‚é–“è³‡è¨Š\nconst genFile = $('ç”Ÿæˆæª”å').item.json;\nconst { dateStr, timeStr, fileName } = genFile;\nreturn { json: { step, driveLink, ...rootItem, dateStr, timeStr, fileName, row_number } };"
      },
      "id": "553f1729-e58f-4ed3-911e-8e4110842030",
      "name": "æº–å‚™çµæœè³‡æ–™",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1776,
        -160
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_PHOTO_REG",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "304620f4-5f53-47a3-82a0-4742e43fec1a"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "è¨»å†Š"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_PHOTO_IN",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a972c340-9f5b-430b-99f4-1875152fe4c3"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ä¸Šç­"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.step }}",
                    "rightValue": "WAIT_PHOTO_OUT",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "c1f727c6-f83c-4034-8c88-e9f3b55223c7"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ä¸‹ç­"
            }
          ]
        },
        "options": {}
      },
      "id": "b0a68393-705a-43a1-bed1-2a62883398c8",
      "name": "å‹•ä½œè·¯ç”±",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        -1552,
        -160
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json.userId }}",
            "è­‰ä»¶ç…§ç‰‡": "={{ $json.driveLink }}"
          },
          "matchingColumns": [
            "UserID"
          ]
        },
        "options": {}
      },
      "id": "67406a12-850f-48d6-adf5-27a36de1770e",
      "name": "å®Œæˆè¨»å†Šå¯«å…¥",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1328,
        -256
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥å·¥æ™‚ç´€éŒ„",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "æ—¥æœŸ": "={{ $json.dateStr }}",
            "å“¡å·¥å§“å": "={{ $json.emp['æš±ç¨±'] }}",
            "åº—å": "={{ $json.tempData.store }}",
            "ä¸Šç­æ™‚é–“": "={{ $json.timeStr }}",
            "æ‰“å¡ç…§ç‰‡": "={{ $json.driveLink }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "æ—¥æœŸ",
              "displayName": "æ—¥æœŸ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å“¡å·¥å§“å",
              "displayName": "å“¡å·¥å§“å",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "åº—å",
              "displayName": "åº—å",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ä¸Šç­æ™‚é–“",
              "displayName": "ä¸Šç­æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ä¸‹ç­æ™‚é–“",
              "displayName": "ä¸‹ç­æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·¥æ™‚",
              "displayName": "å·¥æ™‚",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ‰“å¡ç…§ç‰‡",
              "displayName": "æ‰“å¡ç…§ç‰‡",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ¥­ç¸¾å›å ±",
              "displayName": "æ¥­ç¸¾å›å ±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "e6f477e6-75aa-4560-844c-0c679a957262",
      "name": "æ–°å¢ä¸Šç­ç´€éŒ„",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1328,
        -144
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥å·¥æ™‚ç´€éŒ„",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "ä¸‹ç­æ™‚é–“": "={{ $json.timeStr }}",
            "æ¥­ç¸¾å›å ±": "={{ $json.driveLink }}",
            "row_number": "={{ $json.row_number }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "æ—¥æœŸ",
              "displayName": "æ—¥æœŸ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å“¡å·¥å§“å",
              "displayName": "å“¡å·¥å§“å",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "åº—å",
              "displayName": "åº—å",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ä¸Šç­æ™‚é–“",
              "displayName": "ä¸Šç­æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ä¸‹ç­æ™‚é–“",
              "displayName": "ä¸‹ç­æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·¥æ™‚",
              "displayName": "å·¥æ™‚",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ‰“å¡ç…§ç‰‡",
              "displayName": "æ‰“å¡ç…§ç‰‡",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ¥­ç¸¾å›å ±",
              "displayName": "æ¥­ç¸¾å›å ±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å‚™è¨»",
              "displayName": "å‚™è¨»",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "7662c1cf-c211-4475-8167-27038e92f231",
      "name": "æ›´æ–°ä¸‹ç­ç´€éŒ„",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1328,
        -32
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('æ“·å–è¨Šæ¯è³‡è¨Š').item.json.userId }}",
            "current_step": "IDLE",
            "temp_data": ""
          },
          "matchingColumns": [
            "UserID"
          ]
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "3be93c9d-d81a-4720-bd75-4c07da00fcc1",
      "name": "é‡ç½®ç‹€æ…‹(å®Œæˆ)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1104,
        -160
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "åˆ†åº—æ¸…å–®",
          "mode": "name"
        },
        "options": {}
      },
      "id": "4b684241-71fb-4293-85b3-fc79a86a6352",
      "name": "è®€å–åˆ†åº—æ¸…å–®",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2000,
        -320
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const stores = $('è®€å–åˆ†åº—æ¸…å–®').item.json || [];\n// å‡è¨­åˆ†åº—æ¸…å–®æœ‰ã€Œåº—åã€æ¬„ä½\n// ä¾éœ€æ±‚å¯èƒ½æœ‰å¤šå€‹æ¬„ä½ï¼Œé€™è£¡åªå–åº—å\nconst items = [];\n// è‹¥æ˜¯ä¾†è‡ª google sheets è®€å–å¤šç­†ï¼Œstores å¯èƒ½æ˜¯é™£åˆ—æˆ–å–®ç­†\n// åœ¨ n8n code node ä¸­ï¼Œ$input.all() å–æ‰€æœ‰\nconst allStores = $('è®€å–åˆ†åº—æ¸…å–®').all().map(i => i.json['åˆ†åº—æ¸…å–®']).filter(n => n);\n\n// å»ºç«‹ Quick Reply Items\nallStores.forEach(s => {\n  items.push({\n    type: 'action',\n    action: {\n      type: 'message',\n      label: s,\n      text: s\n    }\n  });\n});\n\n// åŠ ä¸Šã€Œå–æ¶ˆã€æŒ‰éˆ•\nitems.push({\n  type: 'action',\n  action: {\n    type: 'postback',\n    label: 'å–æ¶ˆ',\n    data: 'action=cancel'\n  }\n});\n\nconst root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\n\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'quickReply',\n    text: t.selectStore || 'è«‹é¸æ“‡åˆ†åº—',\n    quickReplyItems: items\n  }\n};"
      },
      "id": "2a012053-911b-40aa-a957-e8549d41d91e",
      "name": "çµ„è£QuickReply",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1776,
        -320
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.replyType }}",
                    "rightValue": "flex",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "90e2270a-fc8c-4ace-a1bf-58ec7bd7902d"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Flex"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.replyType }}",
                    "rightValue": "quickReply",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e4f8d55c-6091-4994-aff0-f2c253730248"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "QuickReply"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.replyType }}",
                    "rightValue": "text",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "9eb2ae51-fe44-4860-9113-41bbd067c293"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Text"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "id": "23e59074-ce44-4690-84a1-026850c45963",
      "name": "å›è¦†é¡å‹åˆ¤æ–·",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        -688,
        240
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "lineMessagingApi",
        "sendBody": true,
        "contentType": "json",
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ replyToken: $json.replyToken, messages: [{ type: 'flex', altText: $json.altText || $json.text, contents: $json.flexContents }] }) }}",
        "options": {}
      },
      "id": "060d5bfa-51da-4bc5-8ff0-23a544521dd9",
      "name": "çµ±ä¸€Flexå›è¦†",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -416,
        112
      ],
      "credentials": {
        "lineMessagingApi": {
          "id": "UiiMHjlAZGMI80LW",
          "name": "æ‰“å¡æ©Ÿå™¨äºº"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "lineMessagingApi",
        "sendBody": true,
        "contentType": "json",
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ replyToken: $json.replyToken, messages: [{ type: 'text', text: $json.text, quickReply: { items: $json.quickReplyItems } }] }) }}",
        "options": {}
      },
      "id": "1e2f3a4b-56cd-4d8e-90ab-1234567890ab",
      "name": "çµ±ä¸€QuickReplyå›è¦†",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -416,
        288
      ],
      "credentials": {
        "lineMessagingApi": {
          "id": "UiiMHjlAZGMI80LW",
          "name": "æ‰“å¡æ©Ÿå™¨äºº"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "lineMessagingApi",
        "sendBody": true,
        "contentType": "json",
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ replyToken: $json.replyToken, messages: [{ type: 'text', text: $json.text }] }) }}",
        "options": {}
      },
      "id": "89ab45cd-67ef-4890-12ab-3456789012cd",
      "name": "çµ±ä¸€æ–‡å­—å›è¦†",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -416,
        464
      ],
      "credentials": {
        "lineMessagingApi": {
          "id": "UiiMHjlAZGMI80LW",
          "name": "æ‰“å¡æ©Ÿå™¨äºº"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst flowData = $('æº–å‚™çµæœè³‡æ–™').item.json;\nconst t = root.t;\nconst step = flowData.step;\nconst store = flowData.tempData?.store || '';\nconst nowStr = new Date().toLocaleString('zh-TW', { timeZone: 'Asia/Taipei', hour12: false });\n\nlet msg = '';\nif (step === 'WAIT_PHOTO_REG') {\n  msg = t.regOk || 'è¨»å†ŠæˆåŠŸ';\n} else if (step === 'WAIT_PHOTO_IN') {\n  msg = (t.inOk || 'ä¸Šç­æ‰“å¡æˆåŠŸ') + '\\nğŸª ' + store + '\\nâ° ' + nowStr;\n} else if (step === 'WAIT_PHOTO_OUT') {\n  msg = (t.outOk || 'ä¸‹ç­æ‰“å¡æˆåŠŸ') + '\\nğŸª ' + store + '\\nâ° ' + nowStr;\n} else {\n  msg = 'æ“ä½œæˆåŠŸ';\n}\n\nconst flexContents = {\n  type: 'bubble',\n  body: {\n    type: 'box',\n    layout: 'vertical',\n    contents: [\n      { type: 'text', text: msg, weight: 'bold', size: 'lg', wrap: true, color: '#1DB446' }\n    ]\n  }\n};\n\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'flex',\n    text: msg,\n    altText: msg,\n    flexContents\n  }\n};"
      },
      "id": "901a0b5b-213c-4389-9b9a-4c8d5c7e6f8a",
      "name": "æº–å‚™å›è¦†å…§å®¹(æˆåŠŸ)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -880,
        -160
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.cancel\n  }\n};"
      },
      "id": "5a4b7c8d-90e1-42f2-8345-67890abcde12",
      "name": "æº–å‚™å›è¦†(å–æ¶ˆ)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1136,
        -16
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.help\n  }\n};"
      },
      "id": "12345678-90ab-cdef-1234-567890abcdef",
      "name": "æº–å‚™å›è¦†(èªªæ˜)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1136,
        112
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.noClockIn\n  }\n};"
      },
      "id": "abcdef12-3456-7890-abcd-ef1234567890",
      "name": "æº–å‚™å›è¦†(æœªæ‰“å¡)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1872,
        256
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.photoIn\n  }\n};"
      },
      "id": "98765432-10fe-dcba-9876-543210fedcba",
      "name": "æº–å‚™å›è¦†(æ‹ç…§ä¸Šç­)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -832,
        144
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.photoOut\n  }\n};"
      },
      "id": "fedcba98-7654-3210-fedc-ba9876543210",
      "name": "æº–å‚™å›è¦†(æ‹ç…§ä¸‹ç­)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1632,
        368
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.midshift\n  }\n};"
      },
      "id": "a1b2c3d4-e5f6-7890-a1b2-c3d4e5f67890",
      "name": "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸­é€”)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1216,
        432
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.askRevenue\n  }\n};"
      },
      "id": "b2c3d4e5-f678-90a1-b2c3-d4e5f67890a1",
      "name": "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸‹ç­)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1632,
        512
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.revenueOk + '\\n' + t.photoOut\n  }\n};"
      },
      "id": "c3d4e5f6-7890-a1b2-c3d4-e5f67890a1b2",
      "name": "æº–å‚™å›è¦†(æ¥­ç¸¾ç¢ºèª)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1632,
        640
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.askPhoto\n  }\n};"
      },
      "id": "d4e5f678-90a1-b2c3-d4e5-f67890a1b2c3",
      "name": "æº–å‚™å›è¦†(è­‰ä»¶ç…§)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2096,
        56
      ]
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.wrongInput\n  }\n};"
      },
      "id": "e5f67890-a1b2-c3d4-e5f6-7890a1b2c3d4",
      "name": "æº–å‚™å›è¦†(éŒ¯èª¤)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2256,
        -16
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥å·¥æ™‚ç´€éŒ„",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "å“¡å·¥å§“å",
              "lookupValue": "={{ $json.emp.æš±ç¨± }}"
            },
            {
              "lookupColumn": "æ—¥æœŸ",
              "lookupValue": "={{ new Date().getFullYear() + '/' + String(new Date().getMonth()+1).padStart(2,'0') + '/' + String(new Date().getDate()).padStart(2,'0') }}"
            }
          ]
        },
        "options": {}
      },
      "id": "4169c9b1-50e4-4bc6-8739-122904c633a2",
      "name": "æŸ¥è©¢ä»Šæ—¥æ‰“å¡ç´€éŒ„",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -2352,
        96
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const records = $input.all();\nconst emp = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json.emp;\n// åˆ¤æ–·æ˜¯å¦å·²ä¸Šç­ä½†æœªä¸‹ç­\n// records åŒ…å«ä»Šæ—¥æ‰€æœ‰è©²å“¡å·¥ç´€éŒ„\n// æ‰¾ä¸€ç­† \"ä¸Šç­æ™‚é–“\" æœ‰å€¼ ä½† \"ä¸‹ç­æ™‚é–“\" ç©ºçš„\nconst activeShift = records.find(r => r.json['ä¸Šç­æ™‚é–“'] && !r.json['ä¸‹ç­æ™‚é–“']);\nconst clockInStatus = activeShift ? 'active' : 'none';\nlet row_number = 0;\nlet store = null;\nif (activeShift) {\n  // å„ªå…ˆä½¿ç”¨ n8n è‡ªå‹•æ³¨å…¥çš„ row_numberï¼Œè‹¥ç„¡å‰‡å˜—è©¦å¾ json å±¬æ€§æŠ“å–\n  row_number = activeShift.json.row_number || activeShift.row_number || 0;\n  store = activeShift.json['åº—å'] || null;\n}\n\nreturn { json: { clockInStatus, row_number, store, emp, ...$('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json } };"
      },
      "id": "78291f09-21a4-4458-baae-51421f12258d",
      "name": "åˆ¤æ–·ä¸Šä¸‹ç­",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2112,
        96
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.clockInStatus }}",
                    "rightValue": "none",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e458564b-b565-45ad-be96-1ed04b6b1070"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ä¸Šç­"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.clockInStatus }}",
                    "rightValue": "active",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "0df61dc9-a9c1-4b13-a4da-872f2316e6f4"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ä¸‹ç­"
            }
          ]
        },
        "options": {}
      },
      "id": "a1f56b7d-4560-4965-b732-5198030ab652",
      "name": "ä¸Šä¸‹ç­è·¯ç”±",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        -1840,
        -16
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ILgphAVTKI5KIpCJKrT5anlF4GQK8YoHf8JAtAnMN7o",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "å“¡å·¥ç®¡ç†",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('ä¸Šä¸‹ç­è·¯ç”±').item.json.userId }}",
            "current_step": "WAIT_REVENUE",
            "temp_data": "={{ JSON.stringify({ action: 'clockout', store: $json.store, row_number: $json.row_number }) }}",
            "last_active": "={{ new Date().getTime() }}"
          },
          "matchingColumns": [
            "UserID"
          ]
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "b0a68393-705a-43a1-bed1-2a62883398c8",
      "name": "è¨­å®šç­‰æ¥­ç¸¾(ä¸‹ç­)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.4,
      "position": [
        -1504,
        80
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "p8ybn4LezMchfmzj",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const root = $('è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯').item.json;\nconst t = root.t;\nreturn {\n  json: {\n    replyToken: root.replyToken,\n    replyType: 'text',\n    text: t.askRevenue + ' ' + $('åˆ¤æ–·ä¸Šä¸‹ç­').item.json.store\n  }\n};"
      },
      "id": "b2c3d4e5-f678-90a1-b2c3-d4e5f67890a1",
      "name": "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸‹ç­2)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1280,
        80
      ]
    }
  ],
  "connections": {
    "LINE Webhook": {
      "main": [
        [
          {
            "node": "æ“·å–è¨Šæ¯è³‡è¨Š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ“·å–è¨Šæ¯è³‡è¨Š": {
      "main": [
        [
          {
            "node": "æŸ¥è©¢å“¡å·¥è¡¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥è©¢å“¡å·¥è¡¨": {
      "main": [
        [
          {
            "node": "å“¡å·¥æ˜¯å¦å­˜åœ¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å“¡å·¥æ˜¯å¦å­˜åœ¨": {
      "main": [
        [
          {
            "node": "è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "å–å¾—LINEå€‹è³‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å–å¾—LINEå€‹è³‡": {
      "main": [
        [
          {
            "node": "å»ºç«‹æ–°å“¡å·¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å»ºç«‹æ–°å“¡å·¥": {
      "main": [
        [
          {
            "node": "å›è¦†èªè¨€é¸å–®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å›è¦†èªè¨€é¸å–®": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®€å–ç‹€æ…‹èˆ‡ç¿»è­¯": {
      "main": [
        [
          {
            "node": "ç‹€æ…‹è·¯ç”±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç‹€æ…‹è·¯ç”±": {
      "main": [
        [
          {
            "node": "é‡ç½®(å–æ¶ˆ)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æŒ‡ä»¤åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è§£æèªè¨€é¸æ“‡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è§£æåº—å(ä¸Šç­)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è§£æåº—å(ä¸‹ç­)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è§£ææ¥­ç¸¾é‡‘é¡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ˜¯å¦ç‚ºç…§ç‰‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é‡ç½®(å–æ¶ˆ)": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†(å–æ¶ˆ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŒ‡ä»¤åˆ¤æ–·": {
      "main": [
        [
          {
            "node": "æŸ¥è©¢ä»Šæ—¥æ‰“å¡ç´€éŒ„",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æŸ¥è©¢ä»Šæ—¥æ‰“å¡ç´€éŒ„",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æŸ¥è©¢ä»Šæ—¥æ‰“å¡ç´€éŒ„",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æº–å‚™å›è¦†(èªªæ˜)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šç­‰é¸åº—(ä¸Š)": {
      "main": [
        [
          {
            "node": "è®€å–åˆ†åº—æ¸…å–®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥è©¢ä»Šæ—¥ä¸Šç­ç´€éŒ„": {
      "main": [
        [
          {
            "node": "ä»Šæ—¥å·²æ‰“ä¸Šç­?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä»Šæ—¥å·²æ‰“ä¸Šç­?": {
      "main": [
        [
          {
            "node": "è¨­å®šç­‰é¸åº—(ä¸‹)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æº–å‚™å›è¦†(æœªæ‰“å¡)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šç­‰é¸åº—(ä¸‹)": {
      "main": [
        [
          {
            "node": "è®€å–åˆ†åº—æ¸…å–®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æåº—å(ä¸Šç­)": {
      "main": [
        [
          {
            "node": "æŸ¥è©¢æ¯æ—¥æ¥­ç¸¾ç´€éŒ„",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥è©¢æ¯æ—¥æ¥­ç¸¾ç´€éŒ„": {
      "main": [
        [
          {
            "node": "åˆ¤æ–·é–‹æ”¤ç‹€æ…‹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ¤æ–·é–‹æ”¤ç‹€æ…‹": {
      "main": [
        [
          {
            "node": "é–‹æ”¤é¡å‹è·¯ç”±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é–‹æ”¤é¡å‹è·¯ç”±": {
      "main": [
        [
          {
            "node": "æ–°å¢é–‹æ”¤ç´€éŒ„",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è¨­å®šç­‰ç…§ç‰‡(ä¸Š)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è¨­å®šç­‰æ¥­ç¸¾(ä¸­é€”)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ–°å¢é–‹æ”¤ç´€éŒ„": {
      "main": [
        [
          {
            "node": "è¨­å®šç­‰ç…§ç‰‡(ä¸Š)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šç­‰ç…§ç‰‡(ä¸Š)": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†(æ‹ç…§ä¸Šç­)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šç­‰æ¥­ç¸¾(ä¸­é€”)": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸­é€”)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æåº—å(ä¸‹ç­)": {
      "main": [
        [
          {
            "node": "åˆ¤æ–·æ˜¯å¦éœ€æ¥­ç¸¾(ä¸‹)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ¤æ–·æ˜¯å¦éœ€æ¥­ç¸¾(ä¸‹)": {
      "main": [
        [
          {
            "node": "éœ€æ¥­ç¸¾?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "éœ€æ¥­ç¸¾?": {
      "main": [
        [
          {
            "node": "è¨­å®šç­‰æ¥­ç¸¾(ä¸‹)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è¨­å®šç­‰ç…§ç‰‡(ä¸‹)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šç­‰æ¥­ç¸¾(ä¸‹)": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸‹ç­)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šç­‰ç…§ç‰‡(ä¸‹)": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†(æ‹ç…§ä¸‹ç­)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£ææ¥­ç¸¾é‡‘é¡": {
      "main": [
        [
          {
            "node": "å¯«å…¥æ¥­ç¸¾ç´€éŒ„",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å¯«å…¥æ¥­ç¸¾ç´€éŒ„": {
      "main": [
        [
          {
            "node": "æ±ºå®šä¸‹ä¸€æ­¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ±ºå®šä¸‹ä¸€æ­¥": {
      "main": [
        [
          {
            "node": "è¨­å®šç­‰ç…§ç‰‡(æ¥­ç¸¾å¾Œ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šç­‰ç…§ç‰‡(æ¥­ç¸¾å¾Œ)": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†(æ¥­ç¸¾ç¢ºèª)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æèªè¨€é¸æ“‡": {
      "main": [
        [
          {
            "node": "å„²å­˜èªè¨€è¨­å®š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å„²å­˜èªè¨€è¨­å®š": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†(è­‰ä»¶ç…§)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸‹è¼‰LINEç…§ç‰‡": {
      "main": [
        [
          {
            "node": "ä¸Šå‚³Drive",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ˜¯å¦ç‚ºç…§ç‰‡": {
      "main": [
        [
          {
            "node": "ç”Ÿæˆæª”å",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æº–å‚™å›è¦†(éŒ¯èª¤)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”Ÿæˆæª”å": {
      "main": [
        [
          {
            "node": "ä¸‹è¼‰LINEç…§ç‰‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸Šå‚³Drive": {
      "main": [
        [
          {
            "node": "æº–å‚™çµæœè³‡æ–™",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™çµæœè³‡æ–™": {
      "main": [
        [
          {
            "node": "å‹•ä½œè·¯ç”±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å‹•ä½œè·¯ç”±": {
      "main": [
        [
          {
            "node": "å®Œæˆè¨»å†Šå¯«å…¥",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ–°å¢ä¸Šç­ç´€éŒ„",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ›´æ–°ä¸‹ç­ç´€éŒ„",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å®Œæˆè¨»å†Šå¯«å…¥": {
      "main": [
        [
          {
            "node": "é‡ç½®ç‹€æ…‹(å®Œæˆ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ–°å¢ä¸Šç­ç´€éŒ„": {
      "main": [
        [
          {
            "node": "é‡ç½®ç‹€æ…‹(å®Œæˆ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ›´æ–°ä¸‹ç­ç´€éŒ„": {
      "main": [
        [
          {
            "node": "é‡ç½®ç‹€æ…‹(å®Œæˆ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é‡ç½®ç‹€æ…‹(å®Œæˆ)": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†å…§å®¹(æˆåŠŸ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®€å–åˆ†åº—æ¸…å–®": {
      "main": [
        [
          {
            "node": "çµ„è£QuickReply",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "çµ„è£QuickReply": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†å…§å®¹(æˆåŠŸ)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(å–æ¶ˆ)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(èªªæ˜)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(æœªæ‰“å¡)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(æ‹ç…§ä¸Šç­)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(æ‹ç…§ä¸‹ç­)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸­é€”)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸‹ç­)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(æ¥­ç¸¾ç¢ºèª)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(è­‰ä»¶ç…§)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(éŒ¯èª¤)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å›è¦†é¡å‹åˆ¤æ–·": {
      "main": [
        [
          {
            "node": "çµ±ä¸€Flexå›è¦†",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "çµ±ä¸€QuickReplyå›è¦†",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "çµ±ä¸€æ–‡å­—å›è¦†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥è©¢ä»Šæ—¥æ‰“å¡ç´€éŒ„": {
      "main": [
        [
          {
            "node": "åˆ¤æ–·ä¸Šä¸‹ç­",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ¤æ–·ä¸Šä¸‹ç­": {
      "main": [
        [
          {
            "node": "ä¸Šä¸‹ç­è·¯ç”±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸Šä¸‹ç­è·¯ç”±": {
      "main": [
        [
          {
            "node": "è¨­å®šç­‰é¸åº—(ä¸Š)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è¨­å®šç­‰æ¥­ç¸¾(ä¸‹ç­)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šç­‰æ¥­ç¸¾(ä¸‹ç­)": {
      "main": [
        [
          {
            "node": "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸‹ç­2)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æº–å‚™å›è¦†(å•æ¥­ç¸¾ä¸‹ç­2)": {
      "main": [
        [
          {
            "node": "å›è¦†é¡å‹åˆ¤æ–·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "e6bf353f395904dafe49aea994919de0f3fad34808b813e6b38887371480eaeb"
  }
}